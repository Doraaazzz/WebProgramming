<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<f:view>
    <h:head>
        <title>Web lab3</title>
        <link rel="stylesheet" href="assets/css/style.css"/>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js" type="text/javascript" charset="UTF-8"></script>
    </h:head>
    <h:body>
        <header>
            <h1>Лабораторная №3</h1>
            <h2>Воронина Дарья</h2>
            <div>Вариант: 91346</div>
            <div>Группа: P32311</div>
        </header>
        <main>
            <section class="form-wrapper">
                <h2>Координаты</h2>
                <h:form>
                    <p>
                        <label for="x">X: </label>
                        <p:inputText id="x" value="${form.x}" validatorMessage="Должно быть числом от -4 до 4">
                            <f:validator validatorId="formValidator" for="x" />
                        </p:inputText>
                        <p:slider for="x" minValue="-4" maxValue="4" step="1" />
                        <h:message for="x" styleClass="error" />
                    </p>
                    <p>
                        <label for="y">Y: </label>
                        <p:inputText id="y" value="${form.y}" required="required" validatorMessage="Должно быть числом от -5 до 5">
                            <f:validator validatorId="formValidator" for="y" />
                        </p:inputText>
                        <h:message for="y" styleClass="error" />
                    </p>
                    <p>
                        <label for="r">R: </label>
                        <p:inputText styleClass="r" id="r" value="${form.r}" validatorMessage="Должно быть числом от 2 до 5">
                            <f:validator validatorId="formValidator" for="r" />
                        </p:inputText>
                        <p:slider for="r" minValue="2" maxValue="5" step="0.25" onSlide="rChangeHandler()" />
                        <h:message for="r" styleClass="error" />
                    </p>

                    <h:commandButton action="${form.submit()}" value="Проверить" styleClass="button" />
                </h:form>
            </section>
            <section class="graph-wrapper">
                <h2>График</h2>
                <div id="jxgbox" class="jxgbox"></div>
                <ui:repeat var="point" value ="${resultsManager.results}">
                    <point data-x="${point.x}" data-y="${point.y}" data-r="${point.r}" data-hit="${point.hit}" />
                </ui:repeat>
                <p:remoteCommand name="checkArea" action="${form.ajax}" oncomplete="resolveCheckAreaResult(xhr, status, args)" />
            </section>
            <section class="results-wrapper">
                <h2>Предыдущие проверки</h2>
                <h:dataTable id="results-table" border="1" value="${resultsManager.results}" var="result" >
                    <h:column>
                        <f:facet name="header">X</f:facet>
                        <h:outputText value="${result.x}">
                            <f:convertNumber maxFractionDigits="2" />
                        </h:outputText>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Y</f:facet>
                        <h:outputText value="${result.y}">
                            <f:convertNumber maxFractionDigits="2" />
                        </h:outputText>
                    </h:column>
                    <h:column>
                        <f:facet name="header">R</f:facet>
                        <h:outputText value="${result.r}">
                            <f:convertNumber maxFractionDigits="2" />
                        </h:outputText>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Попадание</f:facet>
                        <h:outputText value="${result.hit ? 'Да' : 'Нет'}" />
                    </h:column>
                    <h:column>
                        <f:facet name="header">Дата</f:facet>
                        <h:outputText value="${result.dateString}" />
                    </h:column>
                    <h:column>
                        <f:facet name="header">Время исполнения</f:facet>
                        <h:outputText value="${result.executionTime} мс" />
                    </h:column>
                </h:dataTable>
            </section>
        </main>
        <h:form styleClass="navigate">
            <h:commandButton action="navigateIndex" styleClass="button" value="На стартовую страницу" />
        </h:form>
        <footer>
            ИТМО, 2022
        </footer>
        <script type="text/javascript" src="assets/js/graph.js"></script>
    </h:body>
</f:view>
</html>
